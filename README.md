# Using GAN to Generate Chest X-Ray Images
- The following study presents a model for generating chest X-ray images of normal subjects (without lung disease) and pneumonia patients.
- Through the proposed model, I tried to avoid most of the problems that the GAN models suffer from, in terms of the difficulty of training each of the generator and the discriminant, in addition to the problem of the modal collapse and the perceptual quality, so that I tried through the proposed model, to try to continue the training (to ensure the continuity of the derivability of cost function ) and discovering the features by the discriminator (the most accurate features for each case of the dataset), which leads the generator to focus on them during the training process.
- A conditional model was used for the GAN, and the discriminator was forced to determine whether the medical images are real or not, in addition to identifying the pathological condition in the generated images.
- I used (64, 64, 3) images because I didn't have enough computational resources. 
# Dataset:
![image](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/1218e620-6328-48b1-95d8-20bbbeff794e)
Dataset Link: https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia
# GAN Architecture:
| Generator Architecture    | Discriminator Architecture    |
| :---: | :---: |
|  ![1](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/b67effdb-ba3b-470d-9074-91403a25da31) | ![2](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/eb1fda76-9a03-4ff2-a975-1c4354c9f8d3)|

# Results:
- Samples generated by the generator for each case (healthy person, person with pneumonia).
![image](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/e6c8bc72-83c0-4ab3-aa22-3fc29e646efb)
![image](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/f49438f9-4811-4cd2-a869-313defb18fad)
## Metrics For Image Generation:
- In order to be able to evaluate the images generated by the generating neural network, we can do so by proposing a neural structure dedicated to classifying the images generated by the generating neural network, and then we return to the basic images included in the dataset, and we evaluate the performance of the classified neural network that It was trained on the generated images, in order to see if the learned characteristics of the generated images can give high results on the basic images included in the dataset.
- I used VGG16 for classification.

| Classification NN    | Result    |
| :---: | :---: |
|  ![Capture](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/6e556685-5760-4bc0-b3ec-515484313a7e) |  ![sdf](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/8c6a7e2f-155b-4e5b-ae26-cb7277488754) |

- Now, after training on the images generated by the generator, we will test the neural network on the basic images included in the dataset.
- We will use several measures in the evaluation to study what is the ability of the generative adversarial network to capture the basic features that characterize each class, and whether the second classified network extracted the features included in the generated images.
- Are the attributes that were extracted from the images generated by the generator, can be used on the original images included in the dataset.
- This helps in the ability to study what was actually generated, and whether the focus was really on the cases that the X-ray images made him have pneumonia or not.
- accuracy is: 93.90337423312883%.
- f1_score: 95.75773745997866, recall_score: 99.11626622479977, precision_score: 92.61935483870968.
- Classification Report:

  ![image](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/bc9904b8-6cdb-4c4f-8b8c-f3cd158486b9)

- Confusion Matrix:

  ![image](https://github.com/kaledhoshme123/Using-GAN-to-Generate-Chest-X-Ray-Images/assets/108609519/cab6ec07-b84b-43cf-b74a-1d9abcbbda53)

# Summary:
In the end, we can see that we have reached a neural network that is able to generate accurate images. But the slight variation in the accuracy of the classification for each class is due to the fact that we need more training time for the generative adversarial network, which helps to focus more on the characteristics of each class (because the number of samples in the basic dataset is different for each class (the healthy case, pneumonia)).
